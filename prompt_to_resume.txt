**SV/UVM Guide – Resume Notes**

**Start Here**
- Review `TASKS.md` (repo root) for the authoritative backlog—`OPS-1` remains blocked until system-level Playwright deps are installed, while other previously in-flight items are now wrapped.
- D1 (InteractiveCode SSR guardrails) is ready for review: `connectCollaboration` now no-ops when `window`/`WebSocket` are missing, `InteractiveCode` skips socket wiring without a client, and a Vitest spec covers the SSR fallback. Ran `npm run lint`, `npm test`, and `CI=1 npm run build` successfully.
- Skim `PROJECT_GUIDE.md` if you need product/authoring/visual context.

- Homepage hero refocused on learning CTAs; community stats removed (`src/components/home/HeroSection.tsx`).
- Curriculum landing page now uses a lightweight quick-link card while the rebuilt interactive diagram lives at `/practice/visualizations/uvm-architecture` (`src/app/curriculum/page.tsx`, `src/components/diagrams/InteractiveUvmArchitectureDiagram.tsx`).
- Quick-link data for the verification stack lives in `src/components/diagrams/verification-stack-links.ts` and powers both the curriculum card and placeholder diagram.
- Shared diagram placeholders now live in `src/components/diagrams/DiagramPlaceholder.tsx` and keep the remaining visualizations consistent until their interactive versions return.
- Lesson visits persist to local progress for smarter recommendations (`src/hooks/useCurriculumProgress.ts`, `src/components/curriculum/LessonVisitTracker.tsx`).
- `uvm-link-map` unit test guards diagram routing against missing curriculum content (`tests/unit/uvm-link-map.spec.ts`).
- Engagement dashboard chart now streams in via a dynamic import (`src/components/gamification/EngagementEngine.tsx`, `src/components/gamification/EngagementActivityChart.tsx`).

**Key Open Issues**
- Playwright browsers install automatically, but `npm run test:e2e` still fails here because `npx playwright install-deps` cannot satisfy the required apt packages behind the proxy (`OPS-1`). Rerun once the host has `libatk`, `libxkbcommon`, audio libs, etc.
- Production builds now run ESLint; keep the repo lint-clean before shipping (`M1-2` ready for review).
- Shared time mocking helper now lives in `tests/setup/time-travel.ts` (`QA-5` ready for review); still need to refactor Prisma client usage in server actions (`DX-2`).

- Before committing: `npm run lint`, `npm run test`, `CI=1 ANALYZE=true npm run build`, `npm run bundle:check`, `npm run test:e2e`.
- If the host allows, run `npx playwright install-deps && npx playwright install` prior to Playwright runs; otherwise expect the launch failure noted above.
- Focused E2E sanity: `tests/e2e/curriculum-links.spec.ts`, `tests/e2e/curriculum-nav.spec.ts`, `tests/e2e/exercise-feedback.spec.ts`.
- New smoke coverage: `tests/e2e/curriculum-diagram.spec.ts` walks each quick link to its curriculum destination, and `tests/e2e/uvm-architecture-visual.spec.ts` verifies the interactive diagram panel updates correctly.
- Bundle guard: `npm run bundle:check` reads `.next/analyze/client.json` (generated via `ANALYZE=true npm run build`) and enforces the baseline at `docs/bundle-baseline.json`. Bundle analyzer now falls back gracefully if `@next/bundle-analyzer` is missing—install it to re-enable reports.

**Helpful References**
- Diagram source & link map: `src/components/diagrams/InteractiveUvmArchitectureDiagram.tsx`, `src/components/diagrams/uvm-link-map.ts`.
- Recommendations stack: `src/components/curriculum/Recommendations.tsx`.
- Testing utilities: `tests/e2e/utils/navigation.ts`.
- Config/build: `next.config.mjs`, `package.json` (for reinstating TS/ESLint gates).

**Session Handoff Checklist**
1. Pick the next task from `TASKS.md` and note progress inline.
2. Run lint/tests relevant to the touched code paths.
3. Update this file and `TASKS.md` if scope changes or new issues surface.

**Latest Update – NF-5**
- Verification stack quick links now resolve to anchored curriculum sections; unit spec updated to allow fragment targets while keeping URL validation in place.
- Added a "Tests Configure the Run" subsection to the UVM testbench lesson to back the new anchors and dropped a manual anchor in the sequences lesson for handshake stability.

**Follow-ups – NF-5**
- Keep an eye on future curriculum edits so the `tests-configure-the-run` and `sequencer-and-driver-handshake` anchors stay intact; update the link map if sections move.
- Once more verification lessons gain dedicated anchors, expand the map to cover remaining diagram nodes.
**Latest Update – P5**
- Audited font loading in the app shell, Tailwind config, and global styles; no legacy `@import` rules remain after centralizing loaders.
- Added `src/app/fonts.ts` with `next/font/local` for Cal Sans, Inter (400/700), and JetBrains Mono (400/700) plus swap display and preloading.
- Updated Tailwind font families to use the exported CSS variables with system fallbacks and removed unused `@fontsource/*` dependencies.
- Pointed the code syntax theme at the JetBrains Mono CSS variable so code blocks render with the same stack as `font-mono` utilities.
- Ran `npm run lint`, `npm run test`, `CI=1 ANALYZE=true npm run build`, and `npm run bundle:check`; Playwright remains blocked pending system libs (`OPS-1`).

**Follow-ups – P5**
- Validate downstream consumers (e.g., syntax highlighting themes, `Logo`) continue to use the exported CSS variables—update any lingering `--font-*` references if regressions surface.
- Consider exporting a woff2 version of Cal Sans for lighter payloads in a future pass once design confirms the weight/axis needs.
- Re-run a real-browser audit after `OPS-1` unblocks Playwright to confirm rendered font stacks and swap behavior in CI logs.
