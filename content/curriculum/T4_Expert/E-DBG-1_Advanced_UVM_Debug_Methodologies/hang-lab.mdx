import { InfoPage } from "@/components/templates/InfoPage";
import DebuggingSimulator from "@/components/ui/DebuggingSimulator";

export const metadata = {
  title: "Hang Lab: Practising UVM Deadlock Recovery",
  description: "Use the debugging simulator to rehearse objection tracing, heartbeat analysis, and item_done triage on realistic UVM hangs.",
};

<InfoPage
  title="Hang Lab: Practising UVM Deadlock Recovery"
  uvm_concept_tags={["debug", "hang triage", "objections"]}
>

  ## Lab Setup

  Launch the interactive Hang Lab below to reproduce three common deadlocks:
  1. **Missing `item_done()`** – Driver forgets to release the sequencer.
  2. **Stuck objection** – Component keeps a phase objection raised after stimulus ends.
  3. **Sequencer `grab()` leak** – Emergency sequence never calls `ungrab()`.

  <DebuggingSimulator scenario="hang" />

  Each scenario provides console output, objection traces, and simplified logs. Your task: diagnose the root cause, apply the fix, and confirm the heartbeat/watchdog recovers the run.

  ## Guided Checklist

  - Enable `+UVM_OBJECTION_TRACE` and inspect which component holds the phase open.
  - Watch the `uvm_heartbeat` report—does it stop ticking when the hang occurs?
  - Look at driver logs to ensure every `get_next_item()` is paired with `item_done()`.
  - For `grab()` leaks, check the active sequence list via `uvm_report_sequences`.

  ## Reflection Prompts

  - Which log or trace gave you the decisive clue?
  - Could a custom watchdog or callback detect the issue earlier?
  - How would you write a regression check to prevent the bug from reappearing?

  ## Next Steps

  - Integrate lessons learned into your base test: add watchdogs, heartbeat registration, and objection tracing toggles.
  - Share a short retro with your team—document the symptom, signal, and resolution so future debugging starts faster.
  - Continue with [/curriculum/T4_Expert/E-DBG-1_Advanced_UVM_Debug_Methodologies/index](./index) for broader instrumentation patterns.

</InfoPage>
