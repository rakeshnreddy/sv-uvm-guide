import { InfoPage } from "@/components/templates/InfoPage";
import { Quiz, InteractiveCode } from "@/components/ui";

export const metadata = {
  title: "I-UVM-4: UVM Factory and Overrides",
  description: "Swap component implementations on the fly using the UVM factory's type and instance overrides.",
};

<InfoPage
  title="I-UVM-4: UVM Factory and Overrides"
  uvm_concept_tags={["uvm factory", "overrides"]}
>

## Level 1: Why the Factory Matters

The UVM factory lets you **replace a class without editing the code that creates it**.\
It's like a casting director who can swap actors after the script is written.

## Level 2: Practical Overrides

### Registration and Creation

<InteractiveCode language="systemverilog" code={`class base_driver extends uvm_driver#(seq_item);
  `uvm_component_utils(base_driver)
endclass

class mock_driver extends base_driver;
  `uvm_component_utils(mock_driver)
endclass

class my_env extends uvm_env;
  `uvm_component_utils(my_env)
  base_driver drv;

  function void build_phase(uvm_phase phase);
    super.build_phase(phase);
    drv = base_driver::type_id::create("drv", this);
  endfunction
endclass`} />

### Type Override

<InteractiveCode language="systemverilog" code={`initial begin
  mock_driver::type_id::set_type_override(base_driver::get_type());
  run_test();
end`} />

### Instance Override

<InteractiveCode language="systemverilog" code={`initial begin
  mock_driver::type_id::set_inst_override("*.env.drv");
end`} />

## Level 3: Expert Notes

- Register every class you plan to override; forgetting `uvm_*_utils` makes overrides impossible.
- **Type overrides** affect all creations of a class, while **instance overrides** target specific paths.
- Wildcards in `set_inst_override` apply to multiple components, but be carefulâ€”overriding too broadly can hide bugs.

<Quiz questions={[
  {
    question: "Which method replaces every instance of a class with another type?",
    answers: [
      { text: "set_inst_override", correct: false },
      { text: "set_type_override", correct: true },
      { text: "clone", correct: false }
    ],
    explanation: "`set_type_override` globally swaps one class for another during factory creation."
  },
  {
    question: "Why must a class include `uvm_component_utils` for factory overrides to work?",
    answers: [
      { text: "It enables the class to be randomized", correct: false },
      { text: "It registers the class with the factory", correct: true },
      { text: "It adds a run_phase", correct: false }
    ],
    explanation: "Registration macros insert the hooks the factory uses to create and override objects."
  }
]} />

</InfoPage>

