import { InfoPage } from "@/components/templates/InfoPage";
import { Quiz } from "@/components/ui";

export const metadata = {
  title: "uvm_config_db: set and get | The UVM Universe - Core Concepts",
  description: "Use the UVM configuration database to pass settings down the hierarchy without tight coupling.",
};

<InfoPage
  title="uvm_config_db: set and get"
  uvm_concept_tags={["uvm_config_db", "set", "get"]}
>

  ## uvm_config_db: set and get

  The `uvm_config_db` allows higher-level components or the testbench top to
  pass configuration data down the component hierarchy. A typical use is
  sharing a virtual interface handle with a driver.

  ### `uvm_config_db::set()`

  ```systemverilog
  // In a top-level module or the test
  initial begin
    uvm_config_db#(virtual alu_if)::set(null,
                                        "uvm_test_top.env.agent.drv",
                                        "vif", vif);
  end
  ```

  ### `uvm_config_db::get()`

  ```systemverilog
  // Inside the driver's build_phase
  function void build_phase(uvm_phase phase);
    super.build_phase(phase);
    if (!uvm_config_db#(virtual alu_if)::get(this, "", "vif", vif))
      `uvm_fatal("NOVIF", "Virtual interface not set")
  endfunction
  ```

  ### Practical Usage Patterns

  - Set configuration values in the test or environment; retrieve them in
    lower components during `build_phase`.
  - Use wildcard paths (`"*"`, `"?"`) to apply a setting to multiple
    components at once.
  - Store configuration objects so many components can share the same
    settings.
  - Always check the return value of `get` and provide a meaningful error if
    the field is missing.

  ## Check Your Understanding

  <Quiz questions={[
    {
      question: "Where is `uvm_config_db::set` typically called to pass a virtual interface handle?",
      answers: [
        { text: "In a lower-level driver", correct: false },
        { text: "In the top-level module or test", correct: true },
        { text: "Inside the sequence item", correct: false },
        { text: "Only in the RTL", correct: false }
      ],
      explanation:
        "The test or top-level module places the handle in the configuration database so lower components can retrieve it.",
    },
    {
      question: "What should a component do if `uvm_config_db::get` returns 0?",
      answers: [
        { text: "Ignore the missing value", correct: false },
        { text: "Fall back to a default or issue a fatal error", correct: true },
        { text: "Call `get` again with a wildcard", correct: false },
        { text: "Use `uvm_resource_db` instead", correct: false }
      ],
      explanation:
        "Always handle a failed `get` call explicitly so configuration mistakes don't go unnoticed.",
    },
  ]} />

</InfoPage>