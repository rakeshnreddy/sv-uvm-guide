import { InfoPage } from "@/components/templates/InfoPage";
import { Quiz } from "@/components/ui";

export const metadata = {
  title: "uvm_resource_db and Precedence | The UVM Universe - Core Concepts",
  description: "Resolve configuration conflicts using the underlying resource database and precedence rules.",
};

<InfoPage
  title="uvm_resource_db and Precedence"
  uvm_concept_tags={["uvm_resource_db", "precedence"]}
>

  ## uvm_resource_db and Precedence

  `uvm_resource_db` is the lower-level database that powers
  `uvm_config_db`. Each resource can have an associated *precedence*. When
  multiple writers set the same resource, the value with the highest
  precedence wins.

  ### Example: Competing Resource Settings

  ```systemverilog
  // Two components set the same resource with different precedence values
  uvm_resource_db#(int)::set("*", "timeout", 50, this, 50);   // default
  uvm_resource_db#(int)::set("*", "timeout", 100, this, 100); // higher precedence

  int timeout;
  void'(uvm_resource_db#(int)::read_by_name("*", "timeout", timeout));
  `uvm_info("RESOURCE", $sformatf("timeout=%0d", timeout), UVM_MEDIUM);
  ```

  The second `set` call uses a higher precedence (`100`), so the retrieved
  value is `100` even though an earlier call provided `50`.

  ### Practical Usage Patterns

  - Use `uvm_resource_db` for advanced scenarios when `uvm_config_db` is too
    restrictive.
  - Provide default values with low precedence, then allow tests to override
    them with higher precedence settings.
  - Combine with `uvm_config_db` by accessing the underlying resource for
    fine-grained control.

  ## Check Your Understanding

  <Quiz questions={[
    {
      question: "If two resources with the same name are set with different precedence, which value is returned?",
      answers: [
        { text: "The one set first", correct: false },
        { text: "The one with the highest precedence", correct: true },
        { text: "The one from the lowest scope", correct: false },
        { text: "The database returns both values", correct: false }
      ],
      explanation:
        "Precedence ensures that the resource with the highest value wins when duplicates exist.",
    },
    {
      question: "When should you use `uvm_resource_db` directly instead of `uvm_config_db`?",
      answers: [
        { text: "Whenever you need a virtual interface", correct: false },
        { text: "Only for very advanced or custom configuration mechanisms", correct: true },
        { text: "It should replace `uvm_config_db` in all testbenches", correct: false },
        { text: "To speed up compilation", correct: false }
      ],
      explanation:
        "The resource database is typically used only when you require features like explicit precedence control or custom access patterns.",
    },
  ]} />

</InfoPage>