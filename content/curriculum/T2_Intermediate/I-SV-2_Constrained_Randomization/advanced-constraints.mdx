import { InfoPage } from "@/components/templates/InfoPage";
import InteractiveCode from "@/components/ui/InteractiveCode";
import Quiz from "@/components/ui/Quiz";

export const metadata = {
  title: "Advanced Constraints: implication and iteration | Advanced SystemVerilog for Verification",
  description: "Express conditional and iterative rules with implication and foreach constructs.",
};

<InfoPage
  title="Advanced Constraints: implication and iteration"
  sv_concept_tags={["implication", "iteration", "constraints"]}
>

## Level 1: Why Implication and Iteration?

**The Analogy:** The implication operator is like a contract: *if* the first clause is true, *then* the second must also be true. Iteration with `foreach` lets us apply that contract to every element in an array.

## Level 2: Core Mechanics

### Implication Operator

<InteractiveCode language="systemverilog" code={`class pkt;
  rand bit       is_write;
  rand bit [7:0] addr;
  rand bit [7:0] data[];

  // Only restrict addr when is_write is 1
  constraint c_addr { is_write -> addr inside {[8'h00:8'h0F]}; }
  constraint c_size { data.size() == addr; }
endclass

program test;
  pkt p = new();
  initial repeat (3) begin
    assert(p.randomize());
    $display("is_write=%0b addr=%0h size=%0d", p.is_write, p.addr, p.data.size());
  end
endprogram`} />

### Iteration with `foreach`

<InteractiveCode language="systemverilog" code={`class sample;
  rand bit [7:0] bytes[4];

  // Apply the same range constraint to each element
  constraint c_range { foreach (bytes[i]) bytes[i] inside {[8'h10:8'h1F]}; }
endclass`} />

## Level 3: Expert Tips

- In `A -> B`, the solver evaluates `A` first. If it is false, `B` is ignored, keeping solving efficient.
- `foreach` provides per-element control and works with dynamic or associative arrays.

<Quiz questions={[
  {
    question: "In `mode -> value inside {[1:10]};`, when is the range enforced?",
    answers: [
      { text: "Always", correct: false },
      { text: "Only when `mode` is 1", correct: true },
      { text: "Only when `mode` is 0", correct: false }
    ],
    explanation: "The consequent is applied only when the antecedent is true."
  },
  {
    question: "Which construct applies a constraint to every element of an array?",
    answers: [
      { text: "`foreach`", correct: true },
      { text: "`for`", correct: false },
      { text: "`while`", correct: false }
    ],
    explanation: "`foreach` iterates over array indices during constraint solving."
  }
]} />

</InfoPage>
