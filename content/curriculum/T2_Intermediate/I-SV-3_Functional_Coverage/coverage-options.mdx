import { InfoPage } from "@/components/templates/InfoPage";
import { Quiz, InteractiveCode } from "@/components/ui";

export const metadata = {
  title: "Coverage Options and Sampling | Advanced UVM Techniques & Strategy",
  description: "Learn how covergroup options influence when and how data is sampled.",
};

<InfoPage
  title="Coverage Options and Sampling"
  uvm_concept_tags={["coverage options", "sampling"]}
>

  ## Level 1: The Big Idea

  Coverage points only help if they sample at the right moment. SystemVerilog covergroups provide **options** to control when sampling happens and how results are reported.

  **The Analogy:** A covergroup is like a camera. Sampling options decide when the shutter clicks and how the photos are cataloged.

  ## Level 2: Practical Usage

  ### Automatic vs. Manual Sampling

  -   Define an event to sample automatically: `covergroup cg @(posedge clk);`
  -   Call `cg.sample()` manually when your monitor observes a transaction. See the [analysis components](/curriculum/uvm-building/essentials/analysis-components) page for how monitors publish transactions through analysis ports.

  ### Useful Options

  -   `option.per_instance`: track coverage separately for each instance.
  -   `option.goal`: set the percentage goal that determines completion.
  -   `option.comment`: attach notes such as a V-Plan ID.

  <InteractiveCode>
  ```systemverilog
  covergroup cg_pkt @(posedge clk);
    option.per_instance = 1;
    option.goal = 90;
    option.comment = "VP-3.1";
    cp_kind: coverpoint pkt.kind;
  endgroup

  initial begin
    cg_pkt cov = new;
    // Manual sampling example
    @(posedge clk);
    cov.sample();
  end
  ```
  </InteractiveCode>

  ## Level 3: Expert Insights

  **Gating and Conditional Sampling:** Use `iff` to sample only when a condition is true, preventing meaningless hits.

  **Per-Instance vs. Merge:** Per-instance coverage isolates under-tested blocks, while merged coverage gives an overall view.

  **Coverage Closure Loop:** Coverage reports feed back into constraint tweaks. Review [Constrained Randomization](/curriculum/T2_Intermediate/I-SV-2_Constrained_Randomization) to see how stimulus can be adjusted to hit missing bins.

  ## Quiz

  <Quiz questions={[
    {
      question: "Which option allows each instance of a covergroup to maintain its own coverage results?",
      answers: [
        { text: "`option.per_instance`", correct: true },
        { text: "`option.goal`", correct: false },
        { text: "`option.weight`", correct: false },
        { text: "`option.comment`", correct: false }
      ],
      explanation: "`option.per_instance` ensures coverage is tracked separately for each covergroup instance."
    },
    {
      question: "How do you manually trigger coverage sampling?",
      answers: [
        { text: "Assigning to a coverpoint variable", correct: false },
        { text: "Calling the `sample()` method", correct: true },
        { text: "Using `option.goal`", correct: false },
        { text: "Waiting on `@`", correct: false }
      ],
      explanation: "Calling the `sample()` method causes the covergroup to capture the current values."
    }
  ]} />

</InfoPage>

