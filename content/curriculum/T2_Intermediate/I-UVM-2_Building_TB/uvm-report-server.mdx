import { InfoPage } from "@/components/templates/InfoPage";
import { Quiz } from "@/components/ui";

export const metadata = {
  title: "UVM Report Server and Verbosity | The UVM Universe - Core Concepts",
  description: "Centralized UVM message control and how to override it with a custom report handler.",
};

<InfoPage
  title="UVM Report Server and Verbosity"
  uvm_concept_tags={["report server", "verbosity"]}
>

  ## Level 1: The Testbench Newsroom

  `uvm_report_server` collects every message in the testbench and decides how it is printed.  
  Think of it as a newsroom editor that formats stories before publication.  
  It matters because consistent reporting and verbosity control make debugging manageable.

  ## Level 2: Custom Report Handler Example

  You can replace a component's default `uvm_report_handler` to redirect messages or change formatting.

  ```systemverilog
class file_report_handler extends uvm_report_handler;
  int fd;
  function new();
    super.new();
    fd = $fopen("run.log","w");
  endfunction

  virtual function void report(uvm_report_server server, uvm_report_message msg);
    $fdisplay(fd,"%s: %s", msg.get_severity_name(), msg.get_msg());
    super.report(server, msg); // keep normal processing
  endfunction
endclass

class my_env extends uvm_env;
  `uvm_component_utils(my_env)
  function void build_phase(uvm_phase phase);
    super.build_phase(phase);
    set_report_handler(new file_report_handler());
  endfunction
endclass
  ```

  ## Level 3: Expert Tips

  - Replace the global server with `uvm_report_server::set_server()` when you need system-wide changes.  
  - `uvm_report_catcher` is handy for filtering messages without writing a new handler.  
  - Use `set_report_verbosity_level` or the `+UVM_VERBOSITY` command-line option to tune output volume.

  ## Check Your Understanding

  <Quiz questions={[
    {
      "question": "What is the primary role of `uvm_report_server`?",
      "answers": [
        { "text": "Scheduling phases", "correct": false },
        { "text": "Formatting and routing UVM messages", "correct": true },
        { "text": "Randomizing transactions", "correct": false },
        { "text": "Configuring the factory", "correct": false }
      ],
      "explanation": "`uvm_report_server` centralizes message formatting and dispatch."
    },
    {
      "question": "How can you replace a component's default reporting behavior?",
      "answers": [
        { "text": "Call `uvm_root::get()`", "correct": false },
        { "text": "Extend `uvm_report_handler` and use `set_report_handler()`", "correct": true },
        { "text": "Invoke `run_test()`", "correct": false },
        { "text": "Change interface connections", "correct": false }
      ],
      "explanation": "Overriding the handler lets you customize how messages are processed."
    }
  ]} />

</InfoPage>
