import { InfoPage } from "@/components/templates/InfoPage";
import { InteractiveCode, Quiz } from "@/components/ui";

export const metadata = {
  title: "Local Variables in Sequences | Advanced SystemVerilog for Verification",
  description: "Capture and reuse values within sequences to create robust properties.",
};

<InfoPage
  title="Local Variables in Sequences"
  sv_concept_tags={["local variables", "sequences"]}
>

  ## Local Variables in Sequences

  Local variables let a sequence remember data from an earlier match and compare it later in the evaluation.

  <InteractiveCode>
  ```systemverilog
  sequence s_store_then_compare;
    logic [7:0] first_data;
    (req, first_data = data) ##1 (ack && data == first_data);
  endsequence

  property p_store_compare;
    @(posedge clk) s_store_then_compare;
  endproperty

  assert property (p_store_compare)
    else $error("Data changed between request and ack");
  ```
  </InteractiveCode>

  ### Why Use Local Variables?

  - Each assertion thread gets its own copy, preventing unintended data sharing.
  - They make it easy to check relationships across time without global state.

  ### Advanced Tips

  - Local variables can be declared `static` if multiple threads must share the same value.
  - Pair local variables with `default clocking` to simplify multi-signal sequences.

  ## Check Your Understanding

  <Quiz questions={[
    {
      question: "What is a key benefit of using local variables inside a sequence?",
      answers: [
        { text: "They share the same value across all assertions", correct: false },
        { text: "Each assertion evaluation has its own copy of the variable", correct: true },
        { text: "They are visible to the entire design", correct: false },
        { text: "They must be declared as `static`", correct: false }
      ],
      explanation: "Local variables are unique per assertion thread, avoiding race conditions."
    },
    {
      question: "How can you capture a signal's value at the beginning of a sequence?",
      answers: [
        { text: "By using a local variable assignment `(sig, local = sig)`", correct: true },
        { text: "By using an immediate assertion", correct: false },
        { text: "By using `disable iff`", correct: false },
        { text: "By writing to a global register", correct: false }
      ],
      explanation: "Local variables can be assigned in the antecedent and referenced later."
    }
  ]} />

</InfoPage>
